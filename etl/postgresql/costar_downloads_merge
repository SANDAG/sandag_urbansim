import os
import os.path

working_dir = r'T:\socioec\pecas\data\Floorspace\costar\Costar2016\Download'
out_file = open(os.path.join(working_dir, 'Costar_merge.csv'),'a')
#GET HEADERS
for line in open(os.path.join(working_dir, 'costar_fields.csv')):
    out_file.write(line)
#DATA:
download_dir = os.path.join(working_dir, 'SubMarkets')
for path, directories, files in os.walk(download_dir):  #SEARCH SUBDIRECTORIES
    for file in files:
            if file.endswith(".csv"):
                f = open(os.path.join(path, file))
                print 'writing file', f
                f.next()                                # SKIP FIRST ROW
                for line in f:
                     out_file.write(line)
                f.close()
out_file.close()
print 'all .csv files merged'